<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>SpeccyBoot: How to use it</title>
    </head>
  
  <link rel="stylesheet" type="text/css" href="speccyboot.css">
    
    <body>
      
        <div id="heading">
          <div id="leftheading">SpeccyBoot</div>
          <div id="rightheading">How to use it</div>
          </div>
        
        <hr>
        
          <p>When you switch on a SpeccyBoot-equipped Spectrum, it will do the
          following:</p>
          
          <ol>
            <li>If Caps Shift is being pressed during start, the machine will
            boot into BASIC, and not continue with the steps below.</li>
            <li>An IP address is obtained using DHCP.</li>
            <li>An attempt to load the file <code>snapshots.lst</code>
            is made (using a TFTP read request, broadcast on your local
            network). If the server has no such file, an attempt is made to
            load and execute a snapshot named <code>menu.z80</code> instead.
            If this also fails, an error message is displayed.</li>
            <li>The contents of <code>snapshots.lst</code> are displayed as a
            menu. When a snapshot is selected, it will be loaded and
            executed.</li>
          </ol>
          
          <p>Configuration is kept to an absolute minimum:</p>
          
          <ul>
            <li>Manual (static) assignment of IP address is not supported
            &mdash; only dynamic (DHCP).</li>
            <li>The TFTP server is found by broadcasting an initial read
            request. Hence, you should not have more than one TFTP server on
            your network.</li>
            <li>More than one SpeccyBoot on the same local network is not
            supported &mdash; the MAC address is fixed.</li>
          </ul>
          
          <p>Here's how to set up SpeccyBoot:</p>
          
          <ul>
            <li><a href="#tftpserver">TFTP server configuration</a></li>
            <li><a href="#syslog">Syslog daemon configuration</a> (optional)</li>
            <li><a href="#loading">Loading snapshots</a></li>
          </ul>

          <hr>
          
          <a name="tftpserver"><h2>TFTP server configuration</h2></a>

          <p>You will need to install and/or activate a TFTP server on a
          computer in your local network. Fortunately, TFTP server software is
          freely available for most platforms. Your TFTP server <b>must be
          capable of responding to broadcast requests</b>, since that is what
          SpeccyBoot uses. Most (but not all) TFTP servers are, and some need
          an explicit option to enable this.</p>
          
          <p>I used the built-in TFTP server of Mac OS X, which can be enabled
          like this:</p>
          
          <p>
          <code># sudo launchctl load -w /System/Library/LaunchDaemons/tftp.plist</code>
          </p>
          
          <p>Most Linux distributions either include a TFTP server by default,
          or allow you to install one quite easily. There are third-party TFTP
          servers for Microsoft Windows too.</p>
          
          <h3>Preparing a directory of snapshots</h3>
          
          <p>Create a directory named <tt>speccyboot</tt> in your TFTP
          servers's main directory (in the case of Mac OS X 10.6, this is
          <tt>/private/tftpboot</tt>; many UNIX clones use <tt>/tftpboot</tt>).
          Copy your Z80 snapshots to this <tt>speccyboot</tt> directory:</p>
          
          <p>
          <code># sudo mkdir /private/tftpboot/speccyboot<br>
          # sudo chown <em>&lt;your-username&gt;</em> /private/tftpboot/speccyboot<br>
          # cd /private/tftpboot/speccyboot<br>
          # cp <em>&lt;path-to-snapshots&gt;</em>/*.z80 .
          </code>
          </p>
          
          <h3>Updating the snapshot index</h3>
          
          <p>After you have created the directory above, and whenever you have
          added or removed a snapshot to/from this directory, you will need to
          update the SpeccyBoot index. This is a (case-insensitively sorted)
          list of snapshots named <tt>snapshots.lst</tt>. On a UNIX machine,
          the script <tt>speccyboot-update</tt> can be used. It is located in
          the <code>utils</code> directory of the SpeccyBoot source code, and
          is installed into <code>/usr/local/bin</code> by <code>make
          install</code>.</p>
          
          <p>To update the snapshot index this way, just type:</p>
          
          <p>
          <code># speccyboot-update</code>
          </p>
          
          <hr>
                    
          <a name="syslog"><h2>Syslog daemon configuration</h2></a>
          
          <p>This step is entirely <b>optional</b>. Actually, the syslog output
          from SpeccyBoot is only useful to the developer, and then only
          marginally so. It will not affect your retro-gaming experience in any
          way.</p>
          
          <p>The SpeccyBoot software uses (a liberal interpretation of) the
          <a href="http://www.ietf.org/rfc/rfc3164.txt">BSD syslog
          protocol</a> for debug messages. Those messages can be viewed using
          a suitably configured machine in your local network.</p>
          
          <p>Just like TFTP, the syslog protocol is supported by virtually all
          UNIX and UNIX-like operating systems. Most UNIX syslog daemons are
          capable of receiving syslog output from other machines in the
          network. However, most syslog daemons also disable this behavior by
          default, so you will likely have to explicitly enable it to see
          SpeccyBoot's messages (mostly debug messages). On Mac OS X, you will
          need to edit 
          <code>/System/Library/LaunchDaemons/com.apple.syslogd.plist</code>,
          and then restart <code>syslogd</code>.
          (<a href="http://www.makemacwork.com/enable-remote-system-logging.htm">More
          details can be found here</a>.)</p>
          
          <p>Here's how it appears in Console.app (SpeccyBoot is 192.168.0.196
          here):</p>
          
          <img src="syslog.png" />

          <p>Another way of viewing the syslog output is <a
          href="http://www.wireshark.org/">Wireshark</a>. Wireshark interprets
          syslog messages correctly, and displays it along with the rest of the
          communication.</p>
          
          <hr>
                    
          <a name="loading"><h2>Loading snapshots</h2></a>

          <p>If the steps above went well, you should now be able to turn on
          your Spectrum, see it figure out its IP address as well as that of
          the TFTP server, and present your list of snapshots. Use the arrow
          keys to navigate the list, the alphabetic keys to jump directly to
          snapshots whose name begin with that letter, and Enter to load the
          selected snapshot.</p>

          <p>To boot into BASIC rather than the SpeccyBoot menu, press Caps
          Shift and keep it pressed while power-cycling/resetting the
          Spectrum.</p>

          <h3>Demo video</h3>
          
          <object width="445" height="364"><param name="movie" value="http://www.youtube.com/v/jGKAelCRKVk&hl=sv&fs=1&rel=0&color1=0x3a3a3a&color2=0x999999&border=1"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/jGKAelCRKVk&hl=sv&fs=1&rel=0&color1=0x3a3a3a&color2=0x999999&border=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="445" height="364"></embed></object>                
      </body>
      <hr>
      &copy; 2009
      <SCRIPT type="text/javascript">eval(unescape('%66%75%6E%63%74%69%6F%6E%20%70%67%72%65%67%67%5F%74%72%61%6E%73%70%6F%73%65%31%28%68%29%20%7B%76%61%72%20%73%3D%27%61%6D%6C%69%6F%74%73%3A%65%70%63%63%62%79%6F%6F%40%74%6D%67%69%61%2E%6C%6F%63%6D%27%3B%76%61%72%20%72%3D%27%27%3B%66%6F%72%28%76%61%72%20%69%3D%30%3B%69%3C%73%2E%6C%65%6E%67%74%68%3B%69%2B%2B%2C%69%2B%2B%29%7B%72%3D%72%2B%73%2E%73%75%62%73%74%72%69%6E%67%28%69%2B%31%2C%69%2B%32%29%2B%73%2E%73%75%62%73%74%72%69%6E%67%28%69%2C%69%2B%31%29%7D%68%2E%68%72%65%66%3D%72%3B%7D%64%6F%63%75%6D%65%6E%74%2E%77%72%69%74%65%28%27%3C%61%20%68%72%65%66%3D%22%23%22%20%6F%6E%4D%6F%75%73%65%4F%76%65%72%3D%22%6A%61%76%61%73%63%72%69%70%74%3A%70%67%72%65%67%67%5F%74%72%61%6E%73%70%6F%73%65%31%28%74%68%69%73%29%22%20%6F%6E%46%6F%63%75%73%3D%22%6A%61%76%61%73%63%72%69%70%74%3A%70%67%72%65%67%67%5F%74%72%61%6E%73%70%6F%73%65%31%28%74%68%69%73%29%22%3E%50%61%74%72%69%6B%20%50%65%72%73%73%6F%6E%3C%2F%61%3E%27%29%3B'))</SCRIPT>
    </html>